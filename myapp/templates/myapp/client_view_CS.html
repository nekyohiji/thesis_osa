<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Community Service Monitoring with QR Scanner</title>

  <!-- Bootstrap CSS & Icons -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
    rel="stylesheet"
  />

  <!-- QR Code Scanner -->
  <script src="https://unpkg.com/html5-qrcode"></script>

  <style>
/* ===== General Page Styling ===== */
body {
  background: #f4f6f9; 
  font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
}

/* ===== Student Card Styling with Gradient ===== */
.student-card {
  border: none;
  border-radius: 16px;
  background: linear-gradient(145deg, #ffffff);
  border: 1px solid #7b0000;
  transition: all 0.25s ease;
  padding: 1rem;
  cursor: pointer;
}

.student-card:hover {
  border: 3px solid #490101ff;
  transform: translateY(-5px);
  background: linear-gradient(145deg, #f4f6f9);
}

/* ===== Card Typography ===== */
.card-title {
  font-size: 1.2rem;
  font-weight: 700;
  color: #222;
  transition: color 0.3s ease, text-decoration 0.3s ease;
}



.card-subtitle {
  font-size: 0.9rem;
  color: #555;
}

/* ===== Progress Bar ===== */
.progress {
  height: 10px;
  border-radius: 5px;
  background-color: rgba(0, 0, 0, 0.05);
  overflow: hidden;
}

.progress-bar {
  background: linear-gradient(90deg, #3b0101ff, #7b0000, #ce1313ff);
  transition: width 0.5s ease;
}

/* ===== Badges ===== */
.badge {
  font-size: 0.8rem;
  padding: 0.35em 0.6em;
  border-radius: 8px;
}

.badge.bg-success {
  background: linear-gradient(90deg, #3b8a3dff, #6bbe70ff) !important;
}

.badge.bg-warning {
  background: linear-gradient(90deg, #e2d02bff, #fff2c7ff) !important;
}

/* ===== Buttons ===== */
.btn {
  font-size: 0.9rem;
  border-radius: 10px;
  font-weight: 500;
}

.btn-primary {
  background: linear-gradient(90deg, #5e0202ff,#b60303ff );
  border: none;
}

.btn-primary:hover {
  background: linear-gradient(90deg, #b60303ff,#5e0202ff );
}

.btn-success {
  background: linear-gradient(90deg, #0f4b2fff, #368f3bff);
  border: none;
}

.btn-success:hover {
  background: linear-gradient(90deg, #368f3bff, #0f4b2fff);
}

/* ===== QR Scanner Modal ===== */
#qr-reader {
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.15);
}

#qr-result {
  font-size: 1rem;
  color: #333;
}

/* ===== Search Bar ===== */
.input-group-text {
  background-color: #ffffff;
  border-right: none;
}

#searchInput {
  border-left: none;
  box-shadow: none !important;
}

/* ===== Table Styling in Logs Modal ===== */
.table {
  font-size: 0.9rem;
}

.table th {
  background-color: #f8f9fa;
}

/* ===== Section Box Styling ===== */
.section-box {
  background: #fff;
  border-radius: 12px;
  border: 1px solid #7b0000;
  box-shadow: 0 3px 10px rgba(123, 0, 0, 0.1);
  padding: 1rem 1.5rem;
  width: 100%;
}

.section-title {
  font-weight: 600;
  font-size: 1.1rem;
  color: #7b0000;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

/* ===== Form Inputs ===== */
input.form-control,
select.form-select {
  border: 1px solid #7b0000;
  border-radius: 8px;
}

input.form-control:focus,
select.form-select:focus {
  outline: none;
  box-shadow: 0 0 5px rgba(123, 0, 0, 0.5);
  border-color: #7b0000;
}


.btn-gradient-logout {
  background: linear-gradient(90deg, #5e0202ff, #b60303ff);
  color: white;
  border: none;
  padding: 0.5rem 1rem;
  border-radius: 6px;
  transition: background 0.3s ease, transform 0.2s ease;
}

.btn-gradient-logout:hover {
  background: linear-gradient(90deg, #b60303ff, #5e0202ff);
  transform: scale(1.05);
  color: white;
}


.qr-header-gradient {
  background: linear-gradient(to bottom, #000000, #440207);
  border-bottom: none; /* removes border for a cleaner gradient look */
}

.modal-header.gradient-dark-red {
  background: linear-gradient(to bottom, #000000, #440207);
  color: white;
  border-bottom: none;
}


  </style>
</head>

<br>

<body>
  <div class="container py-4">

    <!-- Header -->
    <div class="d-flex align-items-center justify-content-between mb-4 text-white"
        style="background: linear-gradient(to right bottom, #000000, #440207, rgb(104, 3, 12));
                background-size: cover;
                background-position: center;
                background-repeat: no-repeat;
                padding: 20px;
                border-radius: 20px;">
    <div class="p-3">
      <h2 class="fw-bold mb-2">
        <i class="bi bi-people-fill me-2"></i>Community Service Monitoring
      </h2>
      <p class="mb-0">
        Track rendered and remaining hours. Scan QR codes to log in/out.
      </p>
    </div>
    </div>



    <!-- Search Bar -->
      <div class="input-group mb-4">
        <span class="input-group-text" style="border: 1px solid #7b0000;">
          <i class="bi bi-search"></i>
        </span>
        <input
          type="text"
          id="searchInput"
          class="form-control"
          placeholder="Search student..."
        />
      </div>
      <hr>


    <!-- Student Cards -->
    <div class="row g-4" id="studentList">


      <!-- STUDENT 1-->
      <div class="col-md-4 student-card-wrapper">
        <div
          class="card student-card p-3"
          data-bs-toggle="modal"
          data-bs-target="#logModal"
        >
          <div class="card-body">
            <h5 class="card-title mb-1">Jochelle Ignacio Aron</h5>
            <p class="card-subtitle text-muted">BS Computer Engineering - 3rd Year</p>

            <div class="mt-3">
              <div class="d-flex justify-content-between small mb-1">
                <span>Hours Rendered</span>
                <span>6 / 10 hrs</span>
              </div>
              <div class="progress">
                <div class="progress-bar bg-success" style="width: 60%"></div>
              </div>
            </div>

            <div class="mt-2">
              <span class="badge bg-success me-1">Rendered: 6 hrs</span>
              <span class="badge bg-warning text-dark">Left: 4 hrs</span>
            </div>

            <div class="mt-3 d-flex gap-2">
              <button
                class="btn btn-primary flex-fill"
                data-bs-toggle="modal"
                data-bs-target="#logModal"
              >
                <i class="bi bi-eye me-1"></i> View Logs
              </button>
              <button
                class="btn btn-success flex-fill"
                data-bs-toggle="modal"
                data-bs-target="#qrScannerModal"
              >
                <i class="bi bi-qr-code-scan me-1"></i> Scan QR
              </button>
            </div>
          </div>
        </div>
      </div>



      <!-- STUDENT 2 -->
      <div class="col-md-4 student-card-wrapper">
        <div
          class="card student-card p-3"
          data-bs-toggle="modal"
          data-bs-target="#logModal"
        >
          <div class="card-body">
            <h5 class="card-title mb-1">Lord Jaisson Cinco Riberal</h5>
            <p class="card-subtitle text-muted">BS Information Technology - 2nd Year</p>

            <div class="mt-3">
              <div class="d-flex justify-content-between small mb-1">
                <span>Hours Rendered</span>
                <span>8 / 10 hrs</span>
              </div>
              <div class="progress">
                <div class="progress-bar bg-success" style="width: 80%"></div>
              </div>
            </div>

            <div class="mt-2">
              <span class="badge bg-success me-1">Rendered: 8 hrs</span>
              <span class="badge bg-warning text-dark">Left: 2 hrs</span>
            </div>

            <div class="mt-3 d-flex gap-2">
              <button
                class="btn btn-primary flex-fill"
                data-bs-toggle="modal"
                data-bs-target="#logModal"
              >
                <i class="bi bi-eye me-1"></i> View Logs
              </button>
              <button
                class="btn btn-success flex-fill"
                data-bs-toggle="modal"
                data-bs-target="#qrScannerModal"
              >
                <i class="bi bi-qr-code-scan me-1"></i> Scan QR
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- STUDENT 3 -->
      <div class="col-md-4 student-card-wrapper">
        <div
          class="card student-card p-3"
          data-bs-toggle="modal"
          data-bs-target="#logModal"
        >
          <div class="card-body">
            <h5 class="card-title mb-1">Xian Erick Mercado Gregorio</h5>
            <p class="card-subtitle text-muted">BS Civil Engineering - 4th Year</p>

            <div class="mt-3">
              <div class="d-flex justify-content-between small mb-1">
                <span>Hours Rendered</span>
                <span>3 / 10 hrs</span>
              </div>
              <div class="progress">
                <div class="progress-bar bg-success" style="width: 30%"></div>
              </div>
            </div>

            <div class="mt-2">
              <span class="badge bg-success me-1">Rendered: 3 hrs</span>
              <span class="badge bg-warning text-dark">Left: 7 hrs</span>
            </div>

            <div class="mt-3 d-flex gap-2">
              <button
                class="btn btn-primary flex-fill"
                data-bs-toggle="modal"
                data-bs-target="#logModal"
              >
                <i class="bi bi-eye me-1"></i> View Logs
              </button>
              <button
                class="btn btn-success flex-fill"
                data-bs-toggle="modal"
                data-bs-target="#qrScannerModal"
              >
                <i class="bi bi-qr-code-scan me-1"></i> Scan QR
              </button>
            </div>
          </div>
        </div>
      </div>
    </div><hr>
    <div class="d-flex justify-content-end">
      <button class="btn-gradient-logout" data-bs-toggle="modal" data-bs-target="#logoutModal">
        <i class="bi bi-box-arrow-right me-1"></i> Logout
      </button>
    </div>
  </div>




  <!-- QR Scanner Modal -->
  <div
  class="modal fade"
  id="qrScannerModal"
  tabindex="-1"
  aria-labelledby="qrScannerModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-header qr-header-gradient text-white">
        <h5 class="modal-title">
          <i class="bi bi-qr-code me-2"></i>QR Code Scanner
        </h5>
        <button
          type="button"
          class="btn-close btn-close-white"
          data-bs-dismiss="modal"
        ></button>
      </div>
      <div class="modal-body text-center">
        <div id="qr-reader" style="width: 100%;"></div>
        <p class="mt-3 fw-bold" id="qr-result">Scan a student's QR code...</p>
      </div>
    </div>
  </div>
</div>





  <!-- Logs Modal -->
  <div class="modal fade" id="logModal" tabindex="-1" aria-labelledby="logModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered">  <!-- wider modal for better layout -->
      <div class="modal-content">
        <div class="modal-header gradient-dark-red">
          <h5 class="modal-title" id="logModalLabel">
            <i class="bi bi-clock-history me-2"></i>Service Logs
          </h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">

          <!-- Student Profile Panel -->
          <div class="row g-2 align-items-stretch">
            <div class="col-md-6 d-flex">
              <div class="section-box w-100">
                <div class="section-title">
                  <i class="bi bi-person-badge"></i> Student Profile
                  <hr>
                </div>

                <div class="mb-2">
                  <label class="form-label">Student ID (TUPC-ID):</label>
                  <input type="text" class="form-control fw-bold text-center" value="TUPC-0374" readonly>
                </div>

                <div class="row mb-2">
                  <div class="col">
                    <label class="form-label">First Name:</label>
                    <input type="text" class="form-control fw-bold text-center" value="LORD JAISSON" readonly>
                  </div>
                  <div class="col">
                    <label class="form-label">Last Name:</label>
                    <input type="text" class="form-control fw-bold text-center" value="RIBERAL" readonly>
                  </div>
                </div>

                <div class="row mb-2">
                  <div class="col">
                    <label class="form-label">Course:</label>
                    <input type="text" class="form-control fw-bold text-center" value="BET-COET" readonly>
                  </div>
                  <div class="col">
                    <label class="form-label">Year Level:</label>
                    <input type="text" class="form-control fw-bold text-center" value="3rd Year" readonly>
                  </div>
                </div>

                <div class="mb-3">
                  <label class="form-label">Remaining Community Service Hours:</label>
                  <input type="text" class="form-control fw-bold text-center text-danger" value="2" readonly>
                </div>
              </div>
            </div>

            <!-- Violations Panel -->
            <div class="col-md-6 d-flex">
              <div class="section-box w-100">
                <div class="section-title mb-2">
                  <i class="bi bi-exclamation-triangle"></i> Violations
                  <hr class="mt-1 mb-2">
                </div>

                <div class="violations-scroll flex-grow-1" style="max-height: 250px; overflow-y:auto;">
                  <!-- Violation 1 -->
                  <div class="bg-light border rounded px-3 py-2 mb-2">
                    <div class="row align-items-center">
                      <div class="col-4">
                        <small class="text-muted d-block mb-1">Type of Violation:</small>
                        <span class="fw-semibold small">Haircut</span>
                      </div>
                      <div class="col-4">
                        <small class="text-muted d-block mb-1">Date:</small>
                        <span class="fw-semibold small">April 30, 2023</span>
                      </div>
                      <div class="col-4 text-end">
                        <a href="#" 
                           class="btn btn-sm btn-outline-secondary small" 
                           data-bs-toggle="modal" 
                           data-bs-target="#violationDetailsModal"
                        >View Details</a>
                      </div>
                    </div>
                  </div>

                  <!-- Violation 2 -->
                  <div class="bg-light border rounded px-3 py-2 mb-2">
                    <div class="row align-items-center">
                      <div class="col-4">
                        <small class="text-muted d-block mb-1">Type of Violation:</small>
                        <span class="fw-semibold small">Late Submission</span>
                      </div>
                      <div class="col-4">
                        <small class="text-muted d-block mb-1">Date:</small>
                        <span class="fw-semibold small">May 10, 2023</span>
                      </div>
                      <div class="col-4 text-end">
                        <a href="#" 
                           class="btn btn-sm btn-outline-secondary small" 
                           data-bs-toggle="modal" 
                           data-bs-target="#violationDetailsModal"
                        >View Details</a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Community Service Log (Card Style) -->
          <div class="row g-2 mt-3">
            <div class="col-12">
              <div class="section-box">
                <div class="section-title">
                  <i class="bi bi-clock-history"></i> Community Service Log
                  <hr>
                </div>

                <p><strong>Total Hours to Complete:</strong> <span class="text-danger">10 hours</span></p>

                <div style="max-height: 250px; overflow-y: auto;">
                  <!-- Log Entry 1 -->
                  <div class="bg-light border rounded px-5 py-2 mb-2" style="border:2px solid #440207;">
                    <div class="row align-items-center">
                      <div class="col-3">
                        <small class="text-muted d-block mb-1">Date:</small>
                        <span class="fw-semibold small">June 18, 2025</span>
                      </div>
                      <div class="col-3">
                        <small class="text-muted d-block mb-1">Time In:</small>
                        <span class="fw-semibold small">8:00 AM</span>
                      </div>
                      <div class="col-3">
                        <small class="text-muted d-block mb-1">Time Out:</small>
                        <span class="fw-semibold small">12:00 PM</span>
                      </div>
                      <div class="col-3 text-center">
                        <small class="text-muted d-block mb-1">Hours Rendered:</small>
                        <span class="fw-semibold small">4 hours</span>
                      </div>
                    </div>
                  </div>

                  <!-- Log Entry 2 -->
                  <div class="bg-light border rounded px-5 py-2 mb-2" style="border:2px solid #440207;">
                    <div class="row align-items-center">
                      <div class="col-3">
                        <small class="text-muted d-block mb-1">Date:</small>
                        <span class="fw-semibold small">June 19, 2025</span>
                      </div>
                      <div class="col-3">
                        <small class="text-muted d-block mb-1">Time In:</small>
                        <span class="fw-semibold small">1:00 PM</span>
                      </div>
                      <div class="col-3">
                        <small class="text-muted d-block mb-1">Time Out:</small>
                        <span class="fw-semibold small">5:00 PM</span>
                      </div>
                      <div class="col-3 text-center">
                        <small class="text-muted d-block mb-1">Hours Rendered:</small>
                        <span class="fw-semibold small">4 hours</span>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="mt-2 text-end">
                  <span class="badge bg-success">Total Rendered Hours: 8 hours</span>
                  <span class="badge bg-warning text-dark">Hours Left: 2 hours</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Violation Details Modal -->
  <div
    class="modal fade"
    id="violationDetailsModal"
    tabindex="-1"
    aria-labelledby="violationDetailsModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-dialog-centered modal-md">
      <div class="modal-content">
        <div class="modal-header gradient-dark-red">
          <h5 class="modal-title" id="violationDetailsModalLabel">
            <i class="bi bi-exclamation-triangle me-2"></i>Violation Details
          </h5>
          <button
            type="button"
            class="btn-close btn-close-white"
            data-bs-dismiss="modal"
          ></button>
        </div>
        <div class="modal-body">
          <p><strong>Type of Violation:</strong> Haircut</p>
          <p><strong>Date:</strong> April 30, 2023</p>
          <p><strong>Description:</strong> Student did not follow dress code by having an unauthorized haircut.</p>
          <p><strong>Action Taken:</strong> Warning issued and community service hours added.</p>
        </div>
        </div>
      </div>
    </div>
  </div>



  <!-- Logout Confirmation Modal -->
<div class="modal fade" id="logoutModal" tabindex="-1" aria-labelledby="logoutModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
      </div>
      <div class="modal-body text-center">
        Are you sure you want to log out?
      </div>
      <div class="modal-footer justify-content-center">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <a href="{% url 'client_CS' %}" class="btn btn-danger">Logout</a>
      </div>
    </div>
  </div>
</div>
  <!-- Bootstrap Bundle JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // Initialize QR Code Scanner on modal show
    let html5QrCode;
    const qrScannerModal = document.getElementById("qrScannerModal");
    const qrResult = document.getElementById("qr-result");

    qrScannerModal.addEventListener("shown.bs.modal", () => {
      html5QrCode = new Html5Qrcode("qr-reader");

      Html5Qrcode.getCameras()
        .then((devices) => {
          if (devices && devices.length) {
            html5QrCode.start(
              { facingMode: "environment" },
              {
                fps: 10,
                qrbox: 250,
              },
              (decodedText, decodedResult) => {
                qrResult.textContent = `Scanned Code: ${decodedText}`;
                // You can add logic here to close modal or process scanned data
              },
              (errorMessage) => {
                // handle scan failure, if needed
              }
            );
          }
        })
        .catch((err) => {
          qrResult.textContent = `Error accessing camera: ${err}`;
        });
    });

    qrScannerModal.addEventListener("hidden.bs.modal", () => {
      if (html5QrCode) {
        html5QrCode.stop().then(() => {
          qrResult.textContent = "Scan a student's QR code...";
          html5QrCode.clear();
        });
      }
    });

    // Simple search functionality
    const searchInput = document.getElementById("searchInput");
    const studentList = document.getElementById("studentList");

    searchInput.addEventListener("input", function () {
      const query = this.value.toLowerCase();

      const cards = studentList.querySelectorAll(".student-card-wrapper");
      cards.forEach((card) => {
        const name = card.querySelector(".card-title").textContent.toLowerCase();
        if (name.includes(query)) {
          card.style.display = "";
        } else {
          card.style.display = "none";
        }
      });
    });
  </script>
</body>
</html>
